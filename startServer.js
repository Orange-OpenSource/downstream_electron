/*!
 * downstream-electron,0.4.0-o.2,2021-03-12 17:01:52.569,castlabs GmbH
 * 
 * Copyright (C) 2017 Castlabs GmbH.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(Q,F){if("object"==typeof exports&&"object"==typeof module)module.exports=F(require("express"),require("cors"));else if("function"==typeof define&&define.amd)define(["express","cors"],F);else{var B="object"==typeof exports?F(require("express"),require("cors")):F(Q.express,Q.cors);for(var U in B)("object"==typeof exports?exports:Q)[U]=B[U]}}(global,function(__WEBPACK_EXTERNAL_MODULE__111__,__WEBPACK_EXTERNAL_MODULE__112__){return f={109:function(Q,F,B){Q.exports=B(110)},110:function(module,exports,__webpack_require__){eval("var express = __webpack_require__(111);\n\nvar cors = __webpack_require__(112);\n\n(function () {\n  process.send({\n    cmd: 'log',\n    log: 'Starting HTTP server'\n  });\n  var server = express();\n  server.use(cors()); // listen for messages\n\n  process.on('message', function (data) {\n    // handles init message\n    if (data.cmd === 'init') {\n      // add content route\n      __webpack_require__(113)(server, data.routeName); // start http server\n\n\n      server.listen(data.port, function () {\n        // http server is listening => send back listening port\n        process.send({\n          cmd: 'listening_port',\n          port: data.port\n        });\n      });\n    }\n  });\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcGkvc2VydmVyL3N0YXJ0U2VydmVyLmpzPzVmYTYiXSwibmFtZXMiOlsiZXhwcmVzcyIsInJlcXVpcmUiLCJjb3JzIiwicHJvY2VzcyIsInNlbmQiLCJjbWQiLCJsb2ciLCJzZXJ2ZXIiLCJ1c2UiLCJvbiIsImRhdGEiLCJyb3V0ZU5hbWUiLCJsaXN0ZW4iLCJwb3J0Il0sIm1hcHBpbmdzIjoiQUFBQSxJQUFNQSxPQUFPLEdBQUdDLG1CQUFPLENBQUMsR0FBRCxDQUF2Qjs7QUFDQSxJQUFNQyxJQUFJLEdBQUdELG1CQUFPLENBQUMsR0FBRCxDQUFwQjs7QUFFQyxhQUFZO0FBRVhFLFNBQU8sQ0FBQ0MsSUFBUixDQUFhO0FBQUNDLE9BQUcsRUFBRSxLQUFOO0FBQ0NDLE9BQUcsRUFBRTtBQUROLEdBQWI7QUFFQSxNQUFJQyxNQUFNLEdBQUdQLE9BQU8sRUFBcEI7QUFDQU8sUUFBTSxDQUFDQyxHQUFQLENBQVdOLElBQUksRUFBZixFQUxXLENBT1g7O0FBQ0FDLFNBQU8sQ0FBQ00sRUFBUixDQUFXLFNBQVgsRUFBc0IsVUFBVUMsSUFBVixFQUFnQjtBQUVwQztBQUNBLFFBQUlBLElBQUksQ0FBQ0wsR0FBTCxLQUFhLE1BQWpCLEVBQXlCO0FBQ3ZCO0FBQ0FKLHlCQUFPLENBQUMsR0FBRCxDQUFQLENBQTBCTSxNQUExQixFQUFrQ0csSUFBSSxDQUFDQyxTQUF2QyxFQUZ1QixDQUd2Qjs7O0FBQ0FKLFlBQU0sQ0FBQ0ssTUFBUCxDQUFjRixJQUFJLENBQUNHLElBQW5CLEVBQXlCLFlBQVk7QUFDbkM7QUFDQVYsZUFBTyxDQUFDQyxJQUFSLENBQWE7QUFBQ0MsYUFBRyxFQUFFLGdCQUFOO0FBQXdCUSxjQUFJLEVBQUVILElBQUksQ0FBQ0c7QUFBbkMsU0FBYjtBQUNELE9BSEQ7QUFJRDtBQUNGLEdBWkQ7QUFhRCxDQXJCQSxHQUFEIiwiZmlsZSI6IjExMC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7XG5jb25zdCBjb3JzID0gcmVxdWlyZSgnY29ycycpO1xuXG4oZnVuY3Rpb24gKCkge1xuXG4gIHByb2Nlc3Muc2VuZCh7Y21kOiAnbG9nJyxcbiAgICAgICAgICAgICAgICBsb2c6ICdTdGFydGluZyBIVFRQIHNlcnZlcid9KTtcbiAgbGV0IHNlcnZlciA9IGV4cHJlc3MoKTtcbiAgc2VydmVyLnVzZShjb3JzKCkpO1xuXG4gIC8vIGxpc3RlbiBmb3IgbWVzc2FnZXNcbiAgcHJvY2Vzcy5vbignbWVzc2FnZScsIGZ1bmN0aW9uIChkYXRhKSB7XG5cbiAgICAvLyBoYW5kbGVzIGluaXQgbWVzc2FnZVxuICAgIGlmIChkYXRhLmNtZCA9PT0gJ2luaXQnKSB7XG4gICAgICAvLyBhZGQgY29udGVudCByb3V0ZVxuICAgICAgcmVxdWlyZSgnLi9jb250ZW50Um91dGUnKShzZXJ2ZXIsIGRhdGEucm91dGVOYW1lKTtcbiAgICAgIC8vIHN0YXJ0IGh0dHAgc2VydmVyXG4gICAgICBzZXJ2ZXIubGlzdGVuKGRhdGEucG9ydCwgZnVuY3Rpb24gKCkge1xuICAgICAgICAvLyBodHRwIHNlcnZlciBpcyBsaXN0ZW5pbmcgPT4gc2VuZCBiYWNrIGxpc3RlbmluZyBwb3J0XG4gICAgICAgIHByb2Nlc3Muc2VuZCh7Y21kOiAnbGlzdGVuaW5nX3BvcnQnLCBwb3J0OiBkYXRhLnBvcnR9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59KCkpO1xuIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///110\n")},111:function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE__111__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJleHByZXNzXCI/MjJmZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiIxMTEuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzExMV9fOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///111\n")},112:function(module,exports){eval("module.exports = __WEBPACK_EXTERNAL_MODULE__112__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJjb3JzXCI/N2U5ZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSIsImZpbGUiOiIxMTIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzExMl9fOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///112\n")},113:function(module,exports,__webpack_require__){"use strict";eval("\n\nvar fs = __webpack_require__(3);\n\nfunction exists(fileUrl, callback) {\n  fs.stat(fileUrl, function (error, stat) {\n    if (error) {\n      callback(false);\n    } else {\n      callback(true, stat.size);\n    }\n  });\n}\n\nvar _promiseCounter = 0;\nvar _promisesObj = {};\n\nfunction _generateRequestId() {\n  var ts = new Date().getTime();\n  var requestId;\n  _promiseCounter++;\n  requestId = _promiseCounter + '-' + ts;\n  return requestId;\n}\n\nfunction processCmd(cmd, args) {\n  var requestId = _generateRequestId();\n\n  var promise = new Promise(function (resolve, reject) {\n    _promisesObj[requestId] = {\n      resolve: resolve,\n      reject: reject\n    };\n  });\n  var request = {};\n  request.requestId = requestId;\n  request.cmd = cmd;\n  request.args = args;\n  process.send(request);\n  return promise;\n}\n\nfunction processMessage(data) {\n  var requestId = data.requestId;\n  var error = data.error;\n  var result = data.result;\n  var promiseObj = _promisesObj[requestId + ''];\n\n  function resolve(result) {\n    promiseObj.resolve(result);\n  }\n\n  if (promiseObj) {\n    if (data.status === 'OK') {\n      resolve(result);\n    } else {\n      promiseObj.reject(error);\n    }\n\n    delete _promisesObj[requestId];\n  }\n}\n/**\n *\n * @private\n * @returns {void}\n */\n\n\nfunction _attachEvents() {\n  process.on('message', processMessage);\n}\n/**\n* ContentRoute\n* @param {object} app - express server instance\n* @constructor\n*/\n\n\nfunction ContentRoute(app, routeName) {\n  var manifestInfo = {};\n\n  _attachEvents();\n  /*------------------------------------------------------------------------------------------*/\n  // ROUTER MANAGEMENT\n\n  /*------------------------------------------------------------------------------------------*/\n\n  /**\n   * Handles get movies/manifestId\n   */\n\n\n  app.get('/' + routeName + '/:id/*', function (req, res) {\n    var manifestId = req.params['id']; // send back file data function\n\n    var sendFile = function sendFile(file) {\n      var options = {\n        dotfiles: 'deny'\n      };\n      res.sendFile(file, options, function (err) {\n        if (err && err.status) {\n          // error to open file => remove saved info (maybe moved)\n          delete manifestInfo[manifestId];\n          res.status(err.status).end();\n        }\n      });\n    };\n\n    var seekIfNeeded = function seekIfNeeded(folder) {\n      var file = folder + '/' + manifestId + '/' + req.params[0];\n      exists(file, function (exists) {\n        if (exists) {\n          // fragment exists on disk, let's check if it is not being downloaded\n          processCmd('is_downloading', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        } else {\n          // fragment doesn't on disk, ask to download it\n          processCmd('perform_seek', {\n            manifest: manifestId,\n            file: file\n          }).then(function () {\n            sendFile(file);\n          })[\"catch\"](function () {\n            return res.status(404).end();\n          });\n        }\n      });\n    };\n\n    var getFile = function getFile(info) {\n      if (info && info.status === 'FINISHED') {\n        // if file has status finished, no need to check if fragment is being downloaded\n        var file = info.folder + '/' + manifestId + '/' + req.params[0];\n        exists(file, function (exists) {\n          if (exists) {\n            // fragment exists => send data\n            sendFile(file);\n          } else {\n            // fragment doesn't exists => 404 and remove cached data\n            delete manifestInfo[manifestId];\n            return res.status(404).end();\n          }\n        });\n      } else {\n        // file is not finished, let's perform seek if needed\n        seekIfNeeded(info.folder);\n      }\n    }; // check if info have been already saved for the manifest\n\n\n    if (manifestInfo[manifestId]) {\n      getFile(manifestInfo[manifestId]);\n    } else {\n      // no info for manifest id, asks main process to get manifest info\n      processCmd('get_info', {\n        manifest: manifestId\n      }).then(function (result) {\n        manifestInfo[manifestId] = result;\n        getFile(manifestInfo[manifestId]);\n      })[\"catch\"](function () {\n        delete manifestInfo[manifestId];\n        return res.status(404).send('Cannot find manifest');\n      });\n    }\n  });\n}\n\nmodule.exports = ContentRoute;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcGkvc2VydmVyL2NvbnRlbnRSb3V0ZS5qcz84NjY4Il0sIm5hbWVzIjpbImZzIiwicmVxdWlyZSIsImV4aXN0cyIsImZpbGVVcmwiLCJjYWxsYmFjayIsInN0YXQiLCJlcnJvciIsInNpemUiLCJfcHJvbWlzZUNvdW50ZXIiLCJfcHJvbWlzZXNPYmoiLCJfZ2VuZXJhdGVSZXF1ZXN0SWQiLCJ0cyIsIkRhdGUiLCJnZXRUaW1lIiwicmVxdWVzdElkIiwicHJvY2Vzc0NtZCIsImNtZCIsImFyZ3MiLCJwcm9taXNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXF1ZXN0IiwicHJvY2VzcyIsInNlbmQiLCJwcm9jZXNzTWVzc2FnZSIsImRhdGEiLCJyZXN1bHQiLCJwcm9taXNlT2JqIiwic3RhdHVzIiwiX2F0dGFjaEV2ZW50cyIsIm9uIiwiQ29udGVudFJvdXRlIiwiYXBwIiwicm91dGVOYW1lIiwibWFuaWZlc3RJbmZvIiwiZ2V0IiwicmVxIiwicmVzIiwibWFuaWZlc3RJZCIsInBhcmFtcyIsInNlbmRGaWxlIiwiZmlsZSIsIm9wdGlvbnMiLCJkb3RmaWxlcyIsImVyciIsImVuZCIsInNlZWtJZk5lZWRlZCIsImZvbGRlciIsIm1hbmlmZXN0IiwidGhlbiIsImdldEZpbGUiLCJpbmZvIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQWE7O0FBRWIsSUFBTUEsRUFBRSxHQUFHQyxtQkFBTyxDQUFDLENBQUQsQ0FBbEI7O0FBRUEsU0FBU0MsTUFBVCxDQUFpQkMsT0FBakIsRUFBMEJDLFFBQTFCLEVBQW9DO0FBQ2xDSixJQUFFLENBQUNLLElBQUgsQ0FBUUYsT0FBUixFQUFpQixVQUFVRyxLQUFWLEVBQWlCRCxJQUFqQixFQUF1QjtBQUN0QyxRQUFJQyxLQUFKLEVBQVc7QUFDVEYsY0FBUSxDQUFDLEtBQUQsQ0FBUjtBQUNELEtBRkQsTUFFTztBQUNMQSxjQUFRLENBQUMsSUFBRCxFQUFPQyxJQUFJLENB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O0FBRUQ2QixNQUFNLENBQUNDLE9BQVAsR0FBaUJ0QixZQUFqQiIsImZpbGUiOiIxMTMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuY29uc3QgZnMgPSByZXF1aXJlKFwiZnNcIik7XG5cbmZ1bmN0aW9uIGV4aXN0cyAoZmlsZVVybCwgY2FsbGJhY2spIHtcbiAgZnMuc3RhdChmaWxlVXJsLCBmdW5jdGlvbiAoZXJyb3IsIHN0YXQpIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNhbGxiYWNrKGZhbHNlKVxuICAgIH0gZWxzZSB7XG4gICAgICBjYWxsYmFjayh0cnVlLCBzdGF0LnNpemUpO1xuICAgIH1cbiAgfSk7XG59XG5cbmxldCBfcHJvbWlzZUNvdW50ZXIgPSAwO1xubGV0IF9wcm9taXNlc09iaiA9IHt9O1xuXG5mdW5jdGlvbiBfZ2VuZXJhdGVSZXF1ZXN0SWQgKCkge1xuICBsZXQgdHMgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgbGV0IHJlcXVlc3RJZDtcbiAgX3Byb21pc2VDb3VudGVyKys7XG4gIHJlcXVlc3RJZCA9IF9wcm9taXNlQ291bnRlciArICctJyArIHRzO1xuICByZXR1cm4gcmVxdWVzdElkO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzQ21kIChjbWQsIGFyZ3MpIHtcbiAgY29uc3QgcmVxdWVzdElkID0gX2dlbmVyYXRlUmVxdWVzdElkKCk7XG4gIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgX3Byb21pc2VzT2JqW3JlcXVlc3RJZF0gPSB7XG4gICAgICByZXNvbHZlOiByZXNvbHZlLFxuICAgICAgcmVqZWN0OiByZWplY3RcbiAgICB9O1xuICB9KTtcbiAgbGV0IHJlcXVlc3QgPSB7fTtcbiAgcmVxdWVzdC5yZXF1ZXN0SWQgPSByZXF1ZXN0SWQ7XG4gIHJlcXVlc3QuY21kID0gY21kO1xuICByZXF1ZXN0LmFyZ3MgPSBhcmdzO1xuICBwcm9jZXNzLnNlbmQocmVxdWVzdCk7XG4gIHJldHVybiBwcm9taXNlO1xufVxuXG5mdW5jdGlvbiBwcm9jZXNzTWVzc2FnZSAoZGF0YSkge1xuICBjb25zdCByZXF1ZXN0SWQgPSBkYXRhLnJlcXVlc3RJZDtcbiAgY29uc3QgZXJyb3IgPSBkYXRhLmVycm9yO1xuICBjb25zdCByZXN1bHQgPSBkYXRhLnJlc3VsdDtcbiAgY29uc3QgcHJvbWlzZU9iaiA9IF9wcm9taXNlc09ialtyZXF1ZXN0SWQgKyAnJ107XG5cbiAgZnVuY3Rpb24gcmVzb2x2ZSAocmVzdWx0KSB7XG4gICAgcHJvbWlzZU9iai5yZXNvbHZlKHJlc3VsdCk7XG4gIH1cblxuICBpZiAocHJvbWlzZU9iaikge1xuICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gJ09LJykge1xuICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwcm9taXNlT2JqLnJlamVjdChlcnJvcik7XG4gICAgfVxuICAgIGRlbGV0ZShfcHJvbWlzZXNPYmpbcmVxdWVzdElkXSk7XG4gIH1cbn1cblxuLyoqXG4gKlxuICogQHByaXZhdGVcbiAqIEByZXR1cm5zIHt2b2lkfVxuICovXG5mdW5jdGlvbiBfYXR0YWNoRXZlbnRzICgpIHtcbiAgcHJvY2Vzcy5vbignbWVzc2FnZScsIHByb2Nlc3NNZXNzYWdlKTtcbn1cblxuLyoqXG4qIENvbnRlbnRSb3V0ZVxuKiBAcGFyYW0ge29iamVjdH0gYXBwIC0gZXhwcmVzcyBzZXJ2ZXIgaW5zdGFuY2VcbiogQGNvbnN0cnVjdG9yXG4qL1xuXG5mdW5jdGlvbiBDb250ZW50Um91dGUgKGFwcCwgcm91dGVOYW1lKSB7XG5cbiAgbGV0IG1hbmlmZXN0SW5mbyA9IHt9O1xuXG4gIF9hdHRhY2hFdmVudHMoKTtcblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLy8gUk9VVEVSIE1BTkFHRU1FTlRcblxuICAvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgZ2V0IG1vdmllcy9tYW5pZmVzdElkXG4gICAqL1xuICBhcHAuZ2V0KCcvJyArIHJvdXRlTmFtZSArICcvOmlkLyonLCBmdW5jdGlvbiAocmVxLCByZXMpIHtcblxuICAgIGxldCBtYW5pZmVzdElkID0gcmVxLnBhcmFtc1snaWQnXTtcblxuICAgIC8vIHNlbmQgYmFjayBmaWxlIGRhdGEgZnVuY3Rpb25cbiAgICBsZXQgc2VuZEZpbGUgPSBmdW5jdGlvbiAoZmlsZSkge1xuICAgICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIGRvdGZpbGVzOiAnZGVueSdcbiAgICAgIH1cbiAgICAgIHJlcy5zZW5kRmlsZShmaWxlLCBvcHRpb25zLCBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgIGlmIChlcnIgJiYgZXJyLnN0YXR1cykge1xuICAgICAgICAgIC8vIGVycm9yIHRvIG9wZW4gZmlsZSA9PiByZW1vdmUgc2F2ZWQgaW5mbyAobWF5YmUgbW92ZWQpXG4gICAgICAgICAgZGVsZXRlIG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXTtcbiAgICAgICAgICByZXMuc3RhdHVzKGVyci5zdGF0dXMpLmVuZCgpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgIH1cblxuICAgIGxldCBzZWVrSWZOZWVkZWQgID0gZnVuY3Rpb24gKGZvbGRlcikge1xuICAgICAgbGV0IGZpbGUgPSBmb2xkZXIgKyAnLycgKyBtYW5pZmVzdElkICsgJy8nICsgcmVxLnBhcmFtc1swXTtcbiAgICAgIGV4aXN0cyhmaWxlLCAoZXhpc3RzKSA9PiB7XG4gICAgICAgIGlmIChleGlzdHMpIHtcbiAgICAgICAgICAvLyBmcmFnbWVudCBleGlzdHMgb24gZGlzaywgbGV0J3MgY2hlY2sgaWYgaXQgaXMgbm90IGJlaW5nIGRvd25sb2FkZWRcbiAgICAgICAgICBwcm9jZXNzQ21kKCdpc19kb3dubG9hZGluZycsIHttYW5pZmVzdDogbWFuaWZlc3RJZCwgZmlsZTogZmlsZX0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBzZW5kRmlsZShmaWxlKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5lbmQoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBmcmFnbWVudCBkb2Vzbid0IG9uIGRpc2ssIGFzayB0byBkb3dubG9hZCBpdFxuICAgICAgICAgIHByb2Nlc3NDbWQoJ3BlcmZvcm1fc2VlaycsIHttYW5pZmVzdDogbWFuaWZlc3RJZCwgZmlsZTogZmlsZX0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBzZW5kRmlsZShmaWxlKVxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5lbmQoKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9XG5cbiAgICBsZXQgZ2V0RmlsZSA9IGZ1bmN0aW9uIChpbmZvKSB7XG4gICAgICBpZiAoaW5mbyAmJiBpbmZvLnN0YXR1cyA9PT0gJ0ZJTklTSEVEJykge1xuICAgICAgICAvLyBpZiBmaWxlIGhhcyBzdGF0dXMgZmluaXNoZWQsIG5vIG5lZWQgdG8gY2hlY2sgaWYgZnJhZ21lbnQgaXMgYmVpbmcgZG93bmxvYWRlZFxuICAgICAgICBsZXQgZmlsZSA9IGluZm8uZm9sZGVyICsgJy8nICsgbWFuaWZlc3RJZCArICcvJyArIHJlcS5wYXJhbXNbMF07XG4gICAgICAgIGV4aXN0cyhmaWxlLCAoZXhpc3RzKSA9PiB7XG4gICAgICAgICAgaWYgKGV4aXN0cykge1xuICAgICAgICAgICAgLy8gZnJhZ21lbnQgZXhpc3RzID0+IHNlbmQgZGF0YVxuICAgICAgICAgICAgc2VuZEZpbGUoZmlsZSlcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gZnJhZ21lbnQgZG9lc24ndCBleGlzdHMgPT4gNDA0IGFuZCByZW1vdmUgY2FjaGVkIGRhdGFcbiAgICAgICAgICAgIGRlbGV0ZSAgbWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdO1xuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5lbmQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZmlsZSBpcyBub3QgZmluaXNoZWQsIGxldCdzIHBlcmZvcm0gc2VlayBpZiBuZWVkZWRcbiAgICAgICAgc2Vla0lmTmVlZGVkKCBpbmZvLmZvbGRlcik7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gY2hlY2sgaWYgaW5mbyBoYXZlIGJlZW4gYWxyZWFkeSBzYXZlZCBmb3IgdGhlIG1hbmlmZXN0XG4gICAgaWYgKG1hbmlmZXN0SW5mb1ttYW5pZmVzdElkXSkge1xuICAgICAgZ2V0RmlsZSggbWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gbm8gaW5mbyBmb3IgbWFuaWZlc3QgaWQsIGFza3MgbWFpbiBwcm9jZXNzIHRvIGdldCBtYW5pZmVzdCBpbmZvXG4gICAgICBwcm9jZXNzQ21kKCdnZXRfaW5mbycsIHttYW5pZmVzdDogbWFuaWZlc3RJZH0pXG4gICAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgbWFuaWZlc3RJbmZvW21hbmlmZXN0SWRdID0gcmVzdWx0O1xuICAgICAgICBnZXRGaWxlKCBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF0pO1xuICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZGVsZXRlICBtYW5pZmVzdEluZm9bbWFuaWZlc3RJZF07XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuc2VuZCgnQ2Fubm90IGZpbmQgbWFuaWZlc3QnKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfSlcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBDb250ZW50Um91dGU7XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///113\n")},3:function(module,exports){eval('module.exports = require("fs");//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZXh0ZXJuYWwgXCJmc1wiP2E0MGQiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEiLCJmaWxlIjoiMy5qcyIsInNvdXJjZXNDb250ZW50IjpbIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZzXCIpOyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///3\n')}},g={},h.m=f,h.c=g,h.d=function(Q,F,B){h.o(Q,F)||Object.defineProperty(Q,F,{enumerable:!0,get:B})},h.r=function(Q){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(Q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(Q,"__esModule",{value:!0})},h.t=function(F,Q){if(1&Q&&(F=h(F)),8&Q)return F;if(4&Q&&"object"==typeof F&&F&&F.__esModule)return F;var B=Object.create(null);if(h.r(B),Object.defineProperty(B,"default",{enumerable:!0,value:F}),2&Q&&"string"!=typeof F)for(var U in F)h.d(B,U,function(Q){return F[Q]}.bind(null,U));return B},h.n=function(Q){var F=Q&&Q.__esModule?function(){return Q.default}:function(){return Q};return h.d(F,"a",F),F},h.o=function(Q,F){return Object.prototype.hasOwnProperty.call(Q,F)},h.p="",h(h.s=109);function h(Q){if(g[Q])return g[Q].exports;var F=g[Q]={i:Q,l:!1,exports:{}};return f[Q].call(F.exports,F,F.exports,h),F.l=!0,F.exports}var f,g});